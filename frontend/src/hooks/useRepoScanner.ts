import { useState } from "react"
import type { ScanResponse } from "../types"

export const useRepoScanner = () => {
    const [data, setData] = useState<ScanResponse | null>(null)
    const [responseError, setResponseError] = useState<{ message: string, timestamp: number } | null>(null)
    const [isLoading, setIsLoading] = useState(false)

    const scan = async (repoUrl: string, token?: string) => {
        setIsLoading(true)
        setData(null)
        setResponseError(null)
        console.log(repoUrl, token ?? "a")

        try {
            /*
            const response = await fetch('/api/scan-repo', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    repo_url: repoUrl,
                    token: token ?? ''
                }),
            })


            if (!response.ok) {
                console.log(response)
                throw new Error(`Server responded with ${response.status}`)
            }

            const responseData: ScanResponse = await response.json()
            */

            const responseData = { "all_results": [{ "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/README.md", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/build.gradle.kts", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/gradle.properties", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/gradlew", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/gradlew.bat", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/settings.gradle.kts", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/build.gradle.kts", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/proguard-rules.pro", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/gradle/libs.versions.toml", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/AndroidManifest.xml", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/androidTest/java/com/example/mapviewer/ExampleInstrumentedTest.kt", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/java/com/example/mapviewer/GPSData.kt", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/java/com/example/mapviewer/MainActivity.kt", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/java/com/example/mapviewer/MapComposable.kt", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/java/com/example/mapviewer/OverlayComposable.kt", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/java/com/example/mapviewer/ui/theme/Color.kt", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/java/com/example/mapviewer/ui/theme/Theme.kt", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/java/com/example/mapviewer/ui/theme/Type.kt", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/drawable/conversion_path_24dp.xml", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/drawable/delete_24dp.xml", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/drawable/ic_launcher_background.xml", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/drawable/ic_launcher_foreground.xml", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/drawable/undo_24dp.xml", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/mipmap-anydpi/ic_launcher.xml", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/mipmap-anydpi/ic_launcher_round.xml", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/mipmap-hdpi/ic_launcher.webp", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/mipmap-hdpi/ic_launcher_round.webp", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/mipmap-mdpi/ic_launcher.webp", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/mipmap-mdpi/ic_launcher_round.webp", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/mipmap-xhdpi/ic_launcher.webp", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/mipmap-xhdpi/ic_launcher_round.webp", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/mipmap-xxhdpi/ic_launcher.webp", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/mipmap-xxhdpi/ic_launcher_round.webp", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/mipmap-xxxhdpi/ic_launcher.webp", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/mipmap-xxxhdpi/ic_launcher_round.webp", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/values/colors.xml", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/values/strings.xml", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/values/themes.xml", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/xml/backup_rules.xml", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/main/res/xml/data_extraction_rules.xml", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/app/src/test/java/com/example/mapviewer/ExampleUnitTest.kt", "has_secrets": false }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [{ "entropy": 4.09, "length": 45, "string": "org/gradle/wrapper/ExclusiveFile..." }, { "entropy": 4.09, "length": 43, "string": "org/gradle/cli/AbstractCommandLi..." }, { "entropy": 4.14, "length": 53, "string": "org/gradle/cli/AbstractPropertie..." }, { "entropy": 4.16, "length": 43, "string": "org/gradle/cli/CommandLineArgume..." }, { "entropy": 4.09, "length": 38, "string": "org/gradle/cli/ParsedCommandLine..." }, { "entropy": 4.05, "length": 52, "string": "org/gradle/cli/ProjectProperties..." }, { "entropy": 4.12, "length": 51, "string": "org/gradle/cli/SystemPropertiesC..." }], "matches_count": 7, "passed": false }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/gradle/wrapper/gradle-wrapper.jar", "has_secrets": true }, { "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [], "matches_count": 0, "passed": true }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/gradle/wrapper/gradle-wrapper.properties", "has_secrets": false }], "findings": [{ "detectors": { "aws_access_key": { "matches": [], "matches_count": 0, "passed": true }, "aws_secret_key": { "matches": [], "matches_count": 0, "passed": true }, "github_token": { "matches": [], "matches_count": 0, "passed": true }, "high_entropy_strings": { "matches": [{ "entropy": 4.09, "length": 45, "string": "org/gradle/wrapper/ExclusiveFile..." }, { "entropy": 4.09, "length": 43, "string": "org/gradle/cli/AbstractCommandLi..." }, { "entropy": 4.14, "length": 53, "string": "org/gradle/cli/AbstractPropertie..." }, { "entropy": 4.16, "length": 43, "string": "org/gradle/cli/CommandLineArgume..." }, { "entropy": 4.09, "length": 38, "string": "org/gradle/cli/ParsedCommandLine..." }, { "entropy": 4.05, "length": 52, "string": "org/gradle/cli/ProjectProperties..." }, { "entropy": 4.12, "length": 51, "string": "org/gradle/cli/SystemPropertiesC..." }], "matches_count": 7, "passed": false }, "private_key_dsa": { "matches": [], "matches_count": 0, "passed": true }, "private_key_ec": { "matches": [], "matches_count": 0, "passed": true }, "private_key_openssh": { "matches": [], "matches_count": 0, "passed": true }, "private_key_rsa": { "matches": [], "matches_count": 0, "passed": true } }, "filename": "/tmp/tmpqzxq079j/gradle/wrapper/gradle-wrapper.jar", "has_secrets": true }], "llm_analysis": { "message": "Security Report: Secret Detection Findings. A scan of the codebase identified several high-entropy strings within '/tmp/tmpqzxq079j/gradle/wrapper/gradle-wrapper.jar'. While no definitive secrets like AWS keys or private keys were found, high entropy can sometimes indicate obfuscated credentials or sensitive data. Recommendation: Conduct a thorough review of the identified high-entropy strings to confirm their nature. If these strings are confirmed to be non-sensitive internal file paths or identifiers, consider refining scan configurations to exclude known build artifacts or implement a baseline for these specific findings. If any sensitive data is discovered, promptly remove it from the codebase and implement secure secret management solutions, such as environment variables or a secret vault." }, "repo_url": "https://github.com/filipdonoval/nauticmap.git", "summary": { "files_with_errors": 0, "files_with_secrets": 1, "total_files_scanned": 43 } }
            setData(responseData)
            throw new Error(`Server responded with fkdlsajfklsdajfklsad`)
        } catch (error: unknown) {
            const message = error instanceof Error ? error.message : "An unexpected error occurred";
            setResponseError({ message, timestamp: Date.now() });
        } finally {
            setIsLoading(false);
        }
    }

    return {
        data,
        responseError,
        isLoading,
        scan
    }
}
